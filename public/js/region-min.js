ol.pkg("ec.linkSelect");(function(){var i=domainShoppingConfig+"/data/region/tree/{id}.json",h=domainShoppingConfig+"/data/region/children/{id}.json",f={},g,j=function(d,b,a){var c;if(b&&(c=f[d])){return a(c)}if(g){g.abort()}g=$.ajax({url:d,type:"get",dataType:"jsonp",success:function(e){if(b){f[d]=e}a(e)},error:function(e,l){logger.warn("load data fail.")}})};ol.linkSelect.region=function(p,s){var e=jQuery,a=e.extend(true,{},ol.linkSelect.region.setting,s),t=e(p),q,b,d=function(o,k){var l;var m=["<select "],n;if(a.ids&&o<a.ids.length&&(n=a.ids[o])){m.push('id="'+n+'"')}if(a.names&&o<a.names.length&&(n=a.names[o])){m.push('name="'+n+'"')}if(a.css&&o<a.css.length&&(n=a.css[o])){m.push('class="'+n+'"')}m.push(" />");var x=e(m.join(""));m=[];if(a.tips&&o<a.tips.length){m.push('<option value="">'+a.tips[o]+"</option>")}for(var w=0;w<k.length;w++){l=k[w];if(l.name=="-"){m.push('<option value="'+l.id+'">\u5176\u5b83\u5730\u533a</option>')}else{m.push('<option value="'+l.id+'">'+l.name+"</option>")}}x.html(m.join("")).change(function(){c(o,this.value)});return x},c=function(m,k){var l=m+1;while(l<b.length){b[l].remove();b.splice(l,1)}if(!k){return}j(r(h,k),true,function(n){if(n.data.length==0){if(a.onchange){a.onchange.call(b[m][0],k)}return}m=m+1;var o=d(m,n.data);b.push(o);q.append(o);o.change()})},r=function(l,k){return l.replace(/{id}/g,k)};this.init=function(){b=[];q=e("<span class='ol_linkSelect ol_linkSelect_region' />");j(r(i,a.defaultValue),true,function(m){var n=[],l,k,v;for(var o=0;o<m.data.length;o++){v=d(o,m.data[o]);if(m.values&&o<m.values.length){v.val(m.values[o])}b.push(v);q.append(v)}b[b.length-1].change();t.empty().append(q)})};this.reset=function(){var k=this;setTimeout(function(){k.init()},100)};this.setValue=function(k){a.defaultValue=k;this.init()};this.init()}})();ol.linkSelect.region.setting={defaultValue:0,css:null,ids:null,names:null,tips:null,onchange:null};
